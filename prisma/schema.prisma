// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextSearch", "fullTextIndex"]
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Asteroid {
  id            Int                  @id @default(autoincrement())
  name          String?
  ownerAddress  String?
  blockchain    Blockchain?
  spectralType  AsteroidSpectralType
  rarity        AsteroidRarity?
  purchaseOrder Int?

  scanStatus AsteroidScanStatus @default(UNSCANNED)
  lastScan   DateTime?

  size        AsteroidSize
  radius      Float
  surfaceArea Float @default(0)

  orbitalPeriod Int
  semiMajorAxis Float
  inclination   Float
  eccentricity  Float

  bonuses      AsteroidBonus[]
  ownerChanges AsteroidOwnerChange[]
}

model AsteroidOwnerChange {
  id          Int         @id @default(autoincrement())
  asteroid    Asteroid    @relation(fields: [asteroidId], references: [id])
  asteroidId  Int
  fromAddress String?
  toAddress   String
  fromChain   Blockchain?
  toChain     Blockchain
  timestamp   DateTime
}

model AsteroidImportRun {
  id             Int       @id @default(autoincrement())
  runningWorkers Int
  start          DateTime
  end            DateTime?
}

enum Blockchain {
  ETHEREUM
  STARKNET
}

enum AsteroidScanStatus {
  UNSCANNED
  LONG_RANGE_SCAN
  ORBITAL_SCAN
}

model AsteroidBonus {
  id         Int               @id @default(autoincrement())
  level      Int
  modifier   Int
  type       AsteroidBonusType
  Asteroid   Asteroid          @relation(fields: [asteroidId], references: [id])
  asteroidId Int
}

enum AsteroidBonusType {
  YIELD
  VOLATILE
  METAL
  ORGANIC
  RARE_EARTH
  FISSILE
}

enum AsteroidSpectralType {
  C
  S
  M
  I
  CI
  CS
  SI
  CM
  SM
  CMS
  CIS
}

enum AsteroidSize {
  SMALL
  MEDIUM
  LARGE
  HUGE
}

enum AsteroidRarity {
  COMMON
  UNCOMMON
  RARE
  SUPERIOR
  EXCEPTIONAL
  INCOMPARABLE
}
